{"ast":null,"code":"var _jsxFileName = \"D:\\\\madad-application\\\\madad-application-main\\\\client\\\\src\\\\components\\\\screens\\\\Home.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect, useContext } from \"react\";\nimport { UserContext } from '../../App';\nimport { Link } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Home = () => {\n  _s();\n\n  const [data, setData] = useState([]);\n  const {\n    state,\n    dispatch\n  } = useContext(UserContext);\n  useEffect(() => {\n    fetch(\"/allpost\", {\n      headers: {\n        //if user is logged in than only user can see the post\n        \"Authorization\": \"hello \" + localStorage.getItem(\"jwt\")\n      }\n    }).then(res => res.json()).then(result => {\n      console.log(result);\n      setData(result.posts);\n    });\n  }, []);\n\n  const likePost = id => {\n    fetch('/like', {\n      method: \"put\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"Authorization\": \"hello \" + localStorage.getItem(\"jwt\")\n      },\n      body: JSON.stringify({\n        postId: id\n      })\n    }).then(res => res.json()).then(result => {\n      const newData = data.map(item => {\n        if (item._id == result._id) {\n          return result;\n        } else {\n          return item;\n        }\n      });\n      setData(newData);\n    }).catch(err => {\n      console.log(err);\n    });\n  };\n\n  const unlikePost = id => {\n    fetch('/unlike', {\n      method: \"put\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"Authorization\": \"hello \" + localStorage.getItem(\"jwt\")\n      },\n      body: JSON.stringify({\n        postId: id\n      })\n    }).then(res => res.json()).then(result => {\n      const newData = data.map(item => {\n        if (item._id == result._id) {\n          return result;\n        } else {\n          return item;\n        }\n      });\n      setData(newData);\n    }).catch(err => {\n      console.log(err);\n    });\n  };\n\n  const makeComment = (text, postId) => {\n    fetch('/comment', {\n      method: \"put\",\n      headers: {\n        \"Content-type\": \"application/json\",\n        \"Authorization\": \"hello \" + localStorage.getItem(\"jwt\")\n      },\n      body: JSON.stringify({\n        // name,\n        postId,\n        text\n      })\n    }).then(res => res.json()).then(result => {\n      console.log(result);\n      const newData = data.map(item => {\n        if (item._id == result._id) {\n          return result;\n        } else {\n          return item;\n        }\n      });\n      setData(newData);\n    }).catch(err => {\n      console.log(err);\n    });\n  };\n\n  const deletePost = postId => {\n    fetch(`/deletepost/${postId}`, {\n      method: \"delete\",\n      headers: {\n        \"Authorization\": \"hello \" + localStorage.getItem(\"jwt\")\n      }\n    }).then(res => res.json()).then(result => {\n      console.log(result);\n      const newData = data.filter(item => {\n        return item._id !== result._id;\n      });\n      setData(newData);\n    });\n  };\n\n  const deleteComment = (postid, commentid) => {\n    fetch(`/deletecomment/${postid}/${commentid}`, {\n      method: \"delete\",\n      headers: {\n        Authorization: \"hello \" + localStorage.getItem(\"jwt\")\n      }\n    }).then(res => res.json()).then(result => {\n      const newData = data.map(item => {\n        if (item._id == result._id) {\n          return result;\n        } else {\n          return item;\n        }\n      });\n      setData(newData);\n    });\n  };\n\n  return (\n    /*#__PURE__*/\n    // <h1>Home</h1>\n    _jsxDEV(\"div\", {\n      className: \"home\",\n      children: data.map(item => {\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"card home-card\",\n          children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n            children: [/*#__PURE__*/_jsxDEV(Link, {\n              to: item.postedBy._id != state._id ? \"/profile/\" + item.postedBy._id : \"/profile/\",\n              children: [item.postedBy.name, \" \"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 144,\n              columnNumber: 17\n            }, this), item.postedBy._id == state._id && /*#__PURE__*/_jsxDEV(\"i\", {\n              class: \"material-icons\",\n              style: {\n                float: \"right\"\n              },\n              onClick: () => deletePost(item._id),\n              children: \"delete\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 146,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 144,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"card-image\",\n            children: /*#__PURE__*/_jsxDEV(\"img\", {\n              src: item.photo\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 151,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 150,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"card-content\",\n            children: [/*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"material-icons\",\n              style: {\n                color: \"red\"\n              },\n              children: \"favorite\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 154,\n              columnNumber: 15\n            }, this), item.likes.includes(state._id) ? /*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"material-icons\",\n              onClick: () => {\n                unlikePost(item._id);\n              },\n              children: \" thumb_down\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 159,\n              columnNumber: 16\n            }, this) : /*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"material-icons\",\n              onClick: () => {\n                likePost(item._id);\n              },\n              children: \"thumb_up  \"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 161,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"h6\", {\n              children: [item.likes.length, \" likes\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 166,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"h6\", {\n              children: item.title\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 167,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: item.body\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 168,\n              columnNumber: 15\n            }, this), item.comments.map(record => {\n              // console.log(record.postedBy.name)\n              return (\n                /*#__PURE__*/\n                // <h6 key={record._id}><span style={{fontWeight:\"500\"}}>{record.postedBy.name}</span>{\" \"}{record.text}\n                // {(item.postedBy._id || record.postedBy._id) == state._id && (\n                // <i className=\"material-icons\" \n                // style={{floast:\"right\"}} \n                // onClick={()=>\n                //   deleteComment(item._id,record._id)\n                // }\n                //   >\n                //   delete\n                //   </i>\n                // )}\n                // </h6>\n                _jsxDEV(\"h6\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    style: {\n                      fontWeight: \"500\"\n                    },\n                    children: record.postedBy.name\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 186,\n                    columnNumber: 23\n                  }, this), \" \", record.text, (item.postedBy._id || record.postedBy._id) == state._id && /*#__PURE__*/_jsxDEV(\"i\", {\n                    className: \"material-icons\",\n                    style: {\n                      float: \"right\"\n                    },\n                    onClick: () => deleteComment(item._id, record._id),\n                    children: \"delete\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 192,\n                    columnNumber: 25\n                  }, this)]\n                }, record._id, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 185,\n                  columnNumber: 21\n                }, this)\n              );\n            }), /*#__PURE__*/_jsxDEV(\"form\", {\n              onSubmit: e => {\n                e.preventDefault();\n                makeComment(e.target[0].value, item._id);\n              },\n              children: /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"text\",\n                placeholder: \"add a comment\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 212,\n                columnNumber: 15\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 208,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 153,\n            columnNumber: 13\n          }, this)]\n        }, item._id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 11\n        }, this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 5\n    }, this)\n  );\n};\n\n_s(Home, \"qutsYUNae4tFdlHcrqn6b5X4TDA=\");\n\n_c = Home;\nexport default Home;\n\nvar _c;\n\n$RefreshReg$(_c, \"Home\");","map":{"version":3,"sources":["D:/madad-application/madad-application-main/client/src/components/screens/Home.js"],"names":["React","useState","useEffect","useContext","UserContext","Link","Home","data","setData","state","dispatch","fetch","headers","localStorage","getItem","then","res","json","result","console","log","posts","likePost","id","method","body","JSON","stringify","postId","newData","map","item","_id","catch","err","unlikePost","makeComment","text","deletePost","filter","deleteComment","postid","commentid","Authorization","postedBy","name","float","photo","color","likes","includes","length","title","comments","record","fontWeight","e","preventDefault","target","value"],"mappings":"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","sourcesContent":["import React, { useState, useEffect ,useContext} from \"react\";\r\nimport {UserContext} from '../../App'\r\nimport {Link} from 'react-router-dom'\r\n\r\nconst Home = () => {\r\n  const [data, setData] = useState([]);\r\n  const {state,dispatch} = useContext(UserContext)\r\n  useEffect(() => {\r\n    fetch(\"/allpost\", {\r\n      headers: {\r\n        //if user is logged in than only user can see the post\r\n        \"Authorization\": \"hello \" + localStorage.getItem(\"jwt\"),\r\n      },\r\n    })\r\n      .then((res) => res.json())\r\n      .then((result) => {\r\n        console.log(result);\r\n        setData(result.posts);\r\n      });\r\n  }, []);\r\n  const likePost = (id)=>{\r\n        fetch('/like',{\r\n          method:\"put\",\r\n          headers:{\r\n            \"Content-Type\":\"application/json\",\r\n            \"Authorization\":\"hello \"+localStorage.getItem(\"jwt\")\r\n          },\r\n          body:JSON.stringify({\r\n            postId:id\r\n          })\r\n        }).then(res=>res.json())\r\n        .then(result=>{\r\n          const newData = data.map(item=>{\r\n            if(item._id==result._id){\r\n              return result\r\n            }\r\n            else{\r\n              return item\r\n            }\r\n          })\r\n          setData(newData)\r\n        }).catch(err=>{\r\n          console.log(err)\r\n        })\r\n  }\r\n  const unlikePost = (id)=>{\r\n    fetch('/unlike',{\r\n      method:\"put\",\r\n      headers:{\r\n        \"Content-Type\":\"application/json\",\r\n        \"Authorization\":\"hello \"+localStorage.getItem(\"jwt\")\r\n      },\r\n      body:JSON.stringify({\r\n        postId:id\r\n      })\r\n    }).then(res=>res.json())\r\n    .then(result=>{\r\n      const newData = data.map(item=>{\r\n        if(item._id==result._id){\r\n          return result\r\n        }\r\n        else{\r\n          return item\r\n        }\r\n      })\r\n      setData(newData)\r\n    }).catch(err=>{\r\n      console.log(err)\r\n    })\r\n}\r\nconst makeComment = (text,postId)=>{\r\n  fetch('/comment',{\r\n    method:\"put\",\r\n    headers:{\r\n      \"Content-type\":\"application/json\",\r\n      \"Authorization\":\"hello \"+localStorage.getItem(\"jwt\")\r\n    },\r\n    body:JSON.stringify({\r\n      // name,\r\n      postId,\r\n      text\r\n    })\r\n  }).then(res=>res.json())\r\n  .then(result=>{\r\n    console.log(result)\r\n    const newData = data.map(item=>{\r\n      if(item._id==result._id){\r\n        return result\r\n      }\r\n      else{\r\n        return item\r\n      }\r\n      \r\n    })\r\n    setData(newData)\r\n  }).catch(err=>{\r\n    console.log(err)\r\n  })\r\n}\r\nconst deletePost = (postId) =>{\r\n  fetch(`/deletepost/${postId}`,{\r\n    method:\"delete\",\r\n    headers:{\r\n      \"Authorization\":\"hello \"+localStorage.getItem(\"jwt\")\r\n    }\r\n  }).then(res=>res.json())\r\n  .then(result=>{\r\n    console.log(result)\r\n    const newData = data.filter(item=>{\r\n      return item._id !== result._id\r\n    })\r\n    setData(newData)\r\n  })\r\n}\r\nconst deleteComment = (postid, commentid) => {\r\n   \r\n  fetch(`/deletecomment/${postid}/${commentid}`, {\r\n    method: \"delete\",\r\n    headers: {\r\n      Authorization: \"hello \" + localStorage.getItem(\"jwt\"),\r\n    },\r\n  })\r\n    .then((res) => res.json())\r\n    .then((result) => {\r\n           const newData = data.map((item) => {\r\n\r\n        if (item._id == result._id) {\r\n                   return result;\r\n        } else {\r\n          return item;\r\n        }\r\n      });\r\n      setData(newData);\r\n    });\r\n};\r\n\r\n\r\n  return (\r\n    // <h1>Home</h1>\r\n    <div className=\"home\">\r\n      {data.map((item) => {\r\n        return (\r\n          <div className=\"card home-card\" key ={item._id}>\r\n            <h5><Link to={item.postedBy._id != state._id ?\"/profile/\"+item.postedBy._id :\"/profile/\" }>{item.postedBy.name} </Link>\r\n            {item.postedBy._id == state._id\r\n             && <i class=\"material-icons\"style={{float:\"right\"}}\r\n             onClick={()=>deletePost(item._id)}>delete</i>\r\n             }          \r\n            </h5>\r\n            <div className=\"card-image\">\r\n              <img src={item.photo}/>\r\n            </div>\r\n            <div className=\"card-content\">\r\n              <i className=\"material-icons\" style={{ color: \"red\" }}>\r\n                favorite\r\n              </i>\r\n              \r\n              {item.likes.includes(state._id)\r\n              ?<i className=\"material-icons\" onClick={()=>{unlikePost(item._id)}}> thumb_down</i>\r\n              :\r\n              <i className=\"material-icons\" onClick={()=>{likePost(item._id)}}\r\n              >thumb_up  </i>\r\n            }\r\n              \r\n              {/* <i className=\"material-icons\" onClick={()=>{unlikePost(item._id)}}> thumb_down</i> */}\r\n              <h6>{item.likes.length} likes</h6>\r\n              <h6>{item.title}</h6>\r\n              <p>{item.body}</p>\r\n              {\r\n                item.comments.map(record=>{\r\n                  // console.log(record.postedBy.name)\r\n                  return (\r\n                    // <h6 key={record._id}><span style={{fontWeight:\"500\"}}>{record.postedBy.name}</span>{\" \"}{record.text}\r\n                    // {(item.postedBy._id || record.postedBy._id) == state._id && (\r\n                    // <i className=\"material-icons\" \r\n                    // style={{floast:\"right\"}} \r\n                    // onClick={()=>\r\n                    //   deleteComment(item._id,record._id)\r\n                    // }\r\n                    //   >\r\n                    //   delete\r\n                    //   </i>\r\n                    // )}\r\n                    // </h6>\r\n                    <h6 key={record._id}>\r\n                      <span style={{ fontWeight: \"500\" }}>\r\n                        {record.postedBy.name}\r\n                      </span>{\" \"}\r\n                      {record.text}\r\n                      {(item.postedBy._id || record.postedBy._id) ==\r\n                        state._id && (\r\n                        <i\r\n                          className=\"material-icons\"\r\n                          style={{\r\n                            float: \"right\",\r\n                          }}\r\n                          onClick={() => deleteComment(item._id, record._id)}\r\n                        >\r\n                          delete\r\n                        </i>\r\n                      )}\r\n                    </h6>\r\n\r\n\r\n                  )\r\n                })\r\n              }\r\n              <form onSubmit ={(e)=>{\r\n                e.preventDefault()\r\n                makeComment(e.target[0].value,item._id)\r\n              }}>\r\n              <input type=\"text\" placeholder=\"add a comment\" />\r\n              </form>\r\n            </div>\r\n          </div>\r\n        );\r\n      })}\r\n    </div>\r\n  );\r\n};\r\nexport default Home;\r\n"]},"metadata":{},"sourceType":"module"}